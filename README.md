# Telegram Chat Manager Bot

Бот для управления названием и фото чата в Telegram, использующий Kurigram (форк Pyrogram).

## Возможности

- **`/rename`** — переименование чата
- **`/repic`** — установка фото чата

## Требования

- Python 3.10+
- Telegram API credentials (API ID и API Hash)

## Установка

1. Клонируйте репозиторий и перейдите в директорию:
```bash
cd bot
```

2. Установите зависимости:
```bash
pip install -r requirements.txt
```

3. Создайте файл `.env` на основе `.env.example`:
```bash
cp .env.example .env
```

4. Отредактируйте `.env` и укажите свои Telegram API credentials:
   - Получите API_ID и API_HASH на https://my.telegram.org/apps

## Запуск

```bash
python main.py
```

При первом запуске потребуется авторизация:
- Введите номер телефона
- Введите код подтверждения из Telegram
- Если включена 2FA, введите пароль

Сессия сохранится в директории `data/` и при следующем запуске авторизация не потребуется.

## Использование

Добавьте бота в группу или супергруппу и выдайте ему права администратора с возможностью:
- Изменять информацию о группе

### Команда /rename

**Переименовать чат, указав новое название:**
```
/rename Новое название чата
```

**Переименовать чат, используя текст из сообщения (reply):**
1. Ответьте на сообщение командой `/rename`
2. Текст из сообщения будет использован как новое название

### Команда /repic

**Установить фото чата из прикрепленного изображения:**
1. Прикрепите фото к сообщению с командой `/repic`

**Установить фото чата из сообщения (reply):**
1. Ответьте на сообщение с фото командой `/repic`
2. Первое фото из сообщения будет установлено как фото чата

## Структура проекта

```
bot/
├── main.py              # Точка входа с uvloop
├── config.py            # Настройки из .env
├── telegram_client.py   # Telegram клиент
├── handlers/
│   ├── __init__.py
│   ├── rename.py        # Обработчик /rename
│   └── repic.py         # Обработчик /repic
├── services/
│   └── chat_manager.py  # Логика работы с чатами
├── requirements.txt
├── .env.example
└── .gitignore
```

## Логирование

Уровень логирования настраивается в `.env` через переменную `LOG_LEVEL`:
- `DEBUG` - подробная отладочная информация
- `INFO` - основная информация (по умолчанию)
- `WARNING` - предупреждения
- `ERROR` - ошибки
- `CRITICAL` - критические ошибки

## Обработка ошибок

Бот автоматически обрабатывает следующие ситуации:
- Отсутствие прав администратора
- Отсутствие текста/фото в сообщении
- Неправильные размеры или формат фото
- Превышение лимита длины названия (255 символов)
- Потеря соединения с Telegram (автоматический реконнект)

## Безопасность

- Сессия Telegram хранится в директории `data/` и не должна публиковаться
- Файл `.env` с API credentials должен быть в `.gitignore`
- Временные файлы фото автоматически удаляются после использования

## Лицензия

MIT
